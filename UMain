unit UMain;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls;

type
  TFMain = class(TForm)
    Memo_plaintext: TMemo;
    Memo_rezult: TMemo;
    Button_open: TButton;
    Open_file_dialog: TOpenDialog;
    Button_start_analyze: TButton;
    Metric_Result: TLabel;
    procedure FormCreate(Sender: TObject);
    procedure Button_openClick(Sender: TObject);
    procedure Button_start_analyzeClick(Sender: TObject);
  private
    open_file:boolean;
  public
    plaintext:string;
  end;

var
  FMain: TFMain;

implementation

{$R *.dfm}

uses Uwork_with_text,UAnalyze_text;

procedure TFMain.FormCreate(Sender: TObject);
begin
  plaintext:='';
  open_file:=false;
end;

procedure TFMain.Button_openClick(Sender: TObject);
begin
  if Open_file_dialog.Execute then
    try
      Memo_plaintext.Lines.LoadFromFile(Open_file_dialog.FileName);
      open_file:=true;
    except
      open_file:=false;
    end;
end;

procedure TFMain.Button_start_analyzeClick(Sender: TObject);
begin
  plaintext:='';
  Prepare_plaintext(plaintext);
  if open_file then
    Analyze_text(plaintext);
  plaintext:='';
end;

end.
